I"Â1<h1 id="ì‹œì‘í•˜ë©°">ì‹œì‘í•˜ë©°</h1>
<p>ì´ ê²Œì‹œê¸€ì€ Python ë…¸ë“œì—ì„œ íŒŒë¼ë¯¸í„°ë¥¼ ì‚¬ìš©í•˜ëŠ” ë°©ë²•ì„ ì •ë¦¬í•©ë‹ˆë‹¤. íŒŒë¼ë¯¸í„°ëŠ” <a href="https://refstop.github.io/posts/ros2-param/">ì§€ë‚œë²ˆ</a>ì— turtlesimìœ¼ë¡œ í•œë²ˆ ì°ë¨¹í•´ë³¸ ì ì´ ìˆìŠµë‹ˆë‹¤. ê°„ë‹¨íˆ ë§í•˜ìë©´ ë…¸ë“œ ë‚´ì—ì„œ ì‚¬ìš©ë˜ëŠ” ë³€ìˆ˜ì´ê³ , ì´ ê°’ì„ ë…¸ë“œ ë‚´ ë˜ëŠ” <code class="language-plaintext highlighter-rouge">ros2 param</code> ëª…ë ¹ì–´ë¥¼ í†µí•´ í™•ì¸í•˜ê±°ë‚˜ ìˆ˜ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ë²ˆ ê²Œì‹œê¸€ì—ì„œëŠ” ì§ì ‘ ìƒì„±, ìˆ˜ì •ì„ í•´ë³´ë„ë¡ í•˜ê² ìŠµë‹ˆë‹¤.</p>

<h1 id="1-parameter-ì „ìš©-íŒ¨í‚¤ì§€-ìƒì„±">1. parameter ì „ìš© íŒ¨í‚¤ì§€ ìƒì„±</h1>
<p>ìš°ì„  íŒŒë¼ë¯¸í„° ì˜ˆì œë¥¼ ì‹¤ìŠµí•  íŒ¨í‚¤ì§€ë¥¼ ìƒì„±í•©ë‹ˆë‹¤. íŒ¨í‚¤ì§€ì˜ ìœ„ì¹˜ëŠ” <code class="language-plaintext highlighter-rouge">~/dev_ws/src</code> í´ë” ì•ˆì…ë‹ˆë‹¤.</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ ros2 pkg create --build-type ament_python python_parameters --dependencies rclpy
</code></pre></div></div>
<p><code class="language-plaintext highlighter-rouge">--dependencies</code> ëª…ë ¹ì–´ë¥¼ í†µí•´ <code class="language-plaintext highlighter-rouge">rclpy</code> ì˜ì¡´ì„± íŒ¨í‚¤ì§€ë¥¼ ì¶”ê°€í•©ë‹ˆë‹¤. ì´ë ‡ê²Œ ì¶”ê°€í•œ ì˜ì¡´ì„±ì€ ìë™ìœ¼ë¡œ <code class="language-plaintext highlighter-rouge">package.xml</code> íŒŒì¼ê³¼ <code class="language-plaintext highlighter-rouge">CMakeLists.txt</code> íŒŒì¼ì— ì˜ì¡´ì„± ë¼ì¸ì´ ì¶”ê°€ë©ë‹ˆë‹¤â€¦.ë§Œ íŒŒì´ì¬ íŒ¨í‚¤ì§€ëŠ” <code class="language-plaintext highlighter-rouge">CMakeLists.txt</code> íŒŒì¼ì´ ì—†ìœ¼ë¯€ë¡œ ì¶”ê°€ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤. <code class="language-plaintext highlighter-rouge">setup.py</code> íŒŒì¼ì—ëŠ” ìë™ìœ¼ë¡œ ì¶”ê°€ë˜ì§€ ì•Šìœ¼ë‹ˆ ìˆ˜ì •í•´ ì¤˜ì•¼ í•©ë‹ˆë‹¤. ìš°ì„  ë…¸ë“œë¶€í„° ì‘ì„± í›„ ìˆ˜ì •í•©ì‹œë‹¤.</p>

<h1 id="2-python-ë…¸ë“œ-ì‘ì„±">2. Python ë…¸ë“œ ì‘ì„±</h1>
<p><code class="language-plaintext highlighter-rouge">dev_ws/src/python_parameters/python_parameters</code> í´ë”ì— <code class="language-plaintext highlighter-rouge">python_parameters_node.py</code> ë…¸ë“œ ì†ŒìŠ¤ íŒŒì¼ì„ ì‘ì„±í•©ë‹ˆë‹¤. ë‚´ìš©ì€ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.</p>
<pre><code class="language-{.python}">import rclpy
import rclpy.node
from rclpy.exceptions import ParameterNotDeclaredException
from rcl_interfaces.msg import ParameterType

class MinimalParam(rclpy.node.Node):
    def __init__(self):
        super().__init__('minimal_param_node')
        timer_period = 2  # seconds
        self.timer = self.create_timer(timer_period, self.timer_callback)

        self.declare_parameter('my_parameter', 'world')

    def timer_callback(self):
        my_param = self.get_parameter('my_parameter').get_parameter_value().string_value

        self.get_logger().info('Hello %s!' % my_param)

        my_new_param = rclpy.parameter.Parameter(
            'my_parameter',
            rclpy.Parameter.Type.STRING,
            'world'
        )
        all_new_parameters = [my_new_param]
        self.set_parameters(all_new_parameters)

def main():
    rclpy.init()
    node = MinimalParam()
    rclpy.spin(node)

if __name__ == '__main__':
    main()
</code></pre>
<p>ì½”ë“œë¥¼ ë¶„ì„í•´ ë´…ì‹œë‹¤. <code class="language-plaintext highlighter-rouge">import</code> ëª…ë ¹ì–´ë¡œ ì˜ì¡´ì„± íŒ¨í‚¤ì§€ë¥¼ ì¶”ê°€í•©ë‹ˆë‹¤. <code class="language-plaintext highlighter-rouge">rclpy.exceptions</code>ëŠ” íŒŒë¼ë¯¸í„°ë¥¼ ì‚¬ìš©í•˜ê±°ë‚˜ ìˆ˜ì •í•˜ê¸° ì „ì— ì„ ì–¸ì´ ì•ˆë˜ìˆìœ¼ë©´ <code class="language-plaintext highlighter-rouge">ParameterNotDeclaredException</code> ì˜ˆì™¸ê°€ ë°œìƒí•˜ê²Œ í•˜ëŠ” ì˜ì¡´ì„±ì…ë‹ˆë‹¤.</p>
<pre><code class="language-{.python}">import rclpy
import rclpy.node
from rclpy.exceptions import ParameterNotDeclaredException
from rcl_interfaces.msg import ParameterType
</code></pre>
<p>ë‹¤ìŒ ë¶€ë¶„ì€ <code class="language-plaintext highlighter-rouge">MinimalParam</code>ì˜ ìƒì„±ì í•¨ìˆ˜ì…ë‹ˆë‹¤. ì´ í•¨ìˆ˜ì—ì„œëŠ” ë…¸ë“œ ì´ë¦„, íƒ€ì´ë¨¸, íŒŒë¼ë¯¸í„° ì„ ì–¸ì„ í•©ë‹ˆë‹¤. íƒ€ì´ë¨¸ëŠ” ì‹œê°„ ê°„ê²© <code class="language-plaintext highlighter-rouge">timer_period</code>ì™€ íƒ€ì´ë¨¸ì— ë§ì¶° ì‹¤í–‰ë  í•¨ìˆ˜ <code class="language-plaintext highlighter-rouge">timer_callback</code>ì„ íƒ€ì´ë¨¸ í•¨ìˆ˜ì— ëŒ€ì…í•©ë‹ˆë‹¤. ê·¸ë¦¬ê³  <code class="language-plaintext highlighter-rouge">declare_parameter</code> í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•˜ì—¬ <code class="language-plaintext highlighter-rouge">my_parameter</code>ë¼ëŠ” ì´ë¦„ì˜ íŒŒë¼ë¯¸í„°ì— <code class="language-plaintext highlighter-rouge">world</code> ë¬¸ìì—´ì„ ì €ì¥í•˜ì—¬ ì´ˆê¸°í™”í•©ë‹ˆë‹¤.</p>
<pre><code class="language-{.python}">class MinimalParam(rclpy.node.Node):
    def __init__(self):
        super().__init__('minimal_param_node')
        timer_period = 2  # seconds
        self.timer = self.create_timer(timer_period, self.timer_callback)

        self.declare_parameter('my_parameter', 'world')
</code></pre>
<p>íƒ€ì´ë¨¸ì— ë”°ë¼ ì‹¤í–‰ë  <code class="language-plaintext highlighter-rouge">timer_callback</code> í•¨ìˆ˜ì…ë‹ˆë‹¤. ì´ í•¨ìˆ˜ëŠ” í˜„ì¬ íŒŒë¼ë¯¸í„°ì˜ ë‚´ìš©ì„ ì¶œë ¥í•´ì£¼ëŠ” ê¸°ëŠ¥ê³¼ <code class="language-plaintext highlighter-rouge">ros2 param set</code> ëª…ë ¹ì–´ë¡œ íŒŒë¼ë¯¸í„°ë¥¼ ìˆ˜ì •í–ˆì„ ë•Œ ë‹¤ì‹œ ì›ë˜ ë‚´ìš©ìœ¼ë¡œ ë˜ëŒë¦¬ëŠ” ê¸°ëŠ¥ì„ ê°–ê³  ìˆìŠµë‹ˆë‹¤. íŒŒë¼ë¯¸í„° ë…¸ë“œ ìƒì„± í´ë˜ìŠ¤ì˜ ë‚´ìš©ì€ ì´ í•¨ìˆ˜ê¹Œì§€ì…ë‹ˆë‹¤.</p>
<pre><code class="language-{.python}">def timer_callback(self):
    my_param = self.get_parameter('my_parameter').get_parameter_value().string_value

    self.get_logger().info('Hello %s!' % my_param)
    # worldë¡œ ë˜ëŒë¦¬ëŠ” êµ¬ë¬¸
    my_new_param = rclpy.parameter.Parameter(
        'my_parameter',
        rclpy.Parameter.Type.STRING,
        'world'
    )
    all_new_parameters = [my_new_param]
    self.set_parameters(all_new_parameters)
</code></pre>
<p>ë§ˆì§€ë§‰ìœ¼ë¡œ ë‚¨ì€ ë¶€ë¶„ì€ mainí•¨ìˆ˜ì™€ mainí•¨ìˆ˜ì˜ ì‹¤í–‰ë¶€ì…ë‹ˆë‹¤.</p>
<pre><code class="language-{.python}">def main():
    rclpy.init()
    node = MinimalParam()
    rclpy.spin(node)

if __name__ == '__main__':
    main()
</code></pre>

<h1 id="3-setuppy-íŒŒì¼-ìˆ˜ì •">3. setup.py íŒŒì¼ ìˆ˜ì •</h1>
<p><code class="language-plaintext highlighter-rouge">setup.py</code> íŒŒì¼ì„ ìˆ˜ì •í•©ë‹ˆë‹¤.</p>
<pre><code class="language-{.python}">entry_points={
    'console_scripts': [
        'param_talker = python_parameters.python_parameters_node:main',
    ],
},
</code></pre>

<h1 id="4-ë¹Œë“œ-ì†ŒìŠ¤-ì‹¤í–‰">4. ë¹Œë“œ, ì†ŒìŠ¤, ì‹¤í–‰</h1>
<p>ì´ ê³¼ì •ì€ ë§ì´ í–ˆìœ¼ë‹ˆ ì„¤ëª…ì€ ìƒëµí•˜ê² ìŠµë‹ˆë‹¤.</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ colcon build --packages-select python_parameters
$ . install/setup.bash
</code></pre></div></div>

<h1 id="ì‹¤í–‰-ê²°ê³¼">ì‹¤í–‰ ê²°ê³¼</h1>
<p>ìœ„ì—ì„œ ì‘ì„±í•œ <code class="language-plaintext highlighter-rouge">param_talker</code> ë…¸ë“œì˜ ì‹¤í–‰ ê²°ê³¼ì…ë‹ˆë‹¤.</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ ros2 run python_parameters param_talker 
[INFO] [minimal_param_node]: Hello world!
[INFO] [minimal_param_node]: Hello world!
[INFO] [minimal_param_node]: Hello world!
[INFO] [minimal_param_node]: Hello world!
[INFO] [minimal_param_node]: Hello world!
[INFO] [minimal_param_node]: Hello world!
</code></pre></div></div>
<p>ì´ì œ <code class="language-plaintext highlighter-rouge">ros2 param set</code> ëª…ë ¹ì–´ë¡œ íŒŒë¼ë¯¸í„°ë¥¼ ìˆ˜ì •í•´ ë³´ê² ìŠµë‹ˆë‹¤.</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ ros2 param set /minimal_param_node my_parameter earth
Set parameter successful
</code></pre></div></div>
<p><code class="language-plaintext highlighter-rouge">param_talker</code> ë…¸ë“œê°€ ì‹¤í–‰ë˜ê³  ìˆëŠ” í„°ë¯¸ë„ì˜ ê²°ê³¼ëŠ” ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ ros2 run python_parameters param_talker 
[INFO] [minimal_param_node]: Hello world!
[INFO] [minimal_param_node]: Hello world!
[INFO] [minimal_param_node]: Hello world!
[INFO] [minimal_param_node]: Hello world!
[INFO] [minimal_param_node]: Hello world!
[INFO] [minimal_param_node]: Hello world!
[INFO] [minimal_param_node]: Hello world!
[INFO] [minimal_param_node]: Hello earth!
[INFO] [minimal_param_node]: Hello world!
[INFO] [minimal_param_node]: Hello world!
</code></pre></div></div>
<p><code class="language-plaintext highlighter-rouge">my_parameter</code> íŒŒë¼ë¯¸í„°ê°€ ì ê¹ <code class="language-plaintext highlighter-rouge">earth</code>ë¡œ ë°”ë€Œì—ˆë‹¤ê°€ ë‹¤ì‹œ <code class="language-plaintext highlighter-rouge">world</code>ë¡œ ëŒì•„ì™”ìŠµë‹ˆë‹¤. ë¬¼ë¡  ìœ„ ì†ŒìŠ¤ì˜ ì›ë˜ëŒ€ë¡œ ë˜ëŒë¦¬ëŠ” ë¶€ë¶„ì„ ì§€ìš°ë©´ <code class="language-plaintext highlighter-rouge">earth</code> ìƒíƒœê°€ ê³ ì •ë©ë‹ˆë‹¤.</p>

<h1 id="launch-íŒŒì¼ì„-ì‚¬ìš©í•œ-íŒŒë¼ë¯¸í„°-ìˆ˜ì •">launch íŒŒì¼ì„ ì‚¬ìš©í•œ íŒŒë¼ë¯¸í„° ìˆ˜ì •</h1>
<p>ê·¸ë ‡ë‹¤ë©´ ì†ŒìŠ¤ëŠ” ê·¸ëŒ€ë¡œ ë‘ê³  íŒŒë¼ë¯¸í„°ë§Œ ìˆ˜ì •í•  ìˆ˜ëŠ” ì—†ì„ê¹Œìš”? launch íŒŒì¼ì„ ì‘ì„±í•˜ë©´ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. <code class="language-plaintext highlighter-rouge">~/dev_ws/src/python_parameters</code> í´ë”ì— <code class="language-plaintext highlighter-rouge">launch</code> í´ë”ë¥¼ ìƒì„±í•˜ì—¬ <code class="language-plaintext highlighter-rouge">python_parameters_launch.py</code> íŒŒì¼ì„ ì‘ì„±í•©ë‹ˆë‹¤. ë‚´ìš©ì€ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.</p>
<pre><code class="language-{.python}">from launch import LaunchDescription
from launch_ros.actions import Node

def generate_launch_description():
    return LaunchDescription([
        Node(
            package='python_parameters',
            node_executable='param_talker',
            node_name='custom_parameter_node',
            output='screen',
            parameters=[
                {'my_parameter': 'earth'}
            ]
        )
    ])
</code></pre>
<p>ê·¸ í›„ <code class="language-plaintext highlighter-rouge">setup.py</code> íŒŒì¼ì— <code class="language-plaintext highlighter-rouge">import</code> êµ¬ë¬¸ê³¼ <code class="language-plaintext highlighter-rouge">data_files</code> ì•ˆì˜ êµ¬ë¬¸ì„ ì¶”ê°€í•©ë‹ˆë‹¤. launch íŒŒì¼ì„ ì‹¤í–‰í•˜ê¸° ìœ„í•´ í•„ìš”í•œ êµ¬ë¬¸ì…ë‹ˆë‹¤.</p>
<pre><code class="language-{.python}">import os
from glob import glob
# ...

setup(
  # ...
  data_files=[
      # ...
      (os.path.join('share', package_name), glob('launch/*_launch.py')),
    ]
  )
</code></pre>
<p>ì¼ë°˜ì ì¸ ë…¸ë“œ ì„ ì–¸ì—ì„œ ë‹¤ìŒ ë¶€ë¶„ì´ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤.</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>parameters=[
    {'my_parameter': 'earth'}
]
</code></pre></div></div>
<p><code class="language-plaintext highlighter-rouge">my_parameter</code> íŒŒë¼ë¯¸í„°ë¥¼ <code class="language-plaintext highlighter-rouge">earth</code>ë¡œ setí•˜ëŠ” ê¸°ëŠ¥ì…ë‹ˆë‹¤. ë¬¼ë¡  ì›ë˜ëŒ€ë¡œ ë˜ëŒë¦¬ëŠ” êµ¬ë¬¸ì— ì˜í•´ ë˜ëŒì•„ì˜¤ê¸´ í•˜ì§€ë§Œ ì´ëŸ° ë°©ì‹ìœ¼ë¡œ launch íŒŒì¼ì—ì„œ íŒŒë¼ë¯¸í„°ë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë‹¤ë§Œ, launch íŒŒì¼ì„ ì‹¤í–‰í•˜ë©´ í„°ë¯¸ë„ ì°½ì— ì¶œë ¥ê°’ì´ ë³´ì´ì§€ ì•Šìœ¼ë¯€ë¡œ <code class="language-plaintext highlighter-rouge">ros2 param get</code> ëª…ë ¹ì–´ë¡œ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ ros2 launch python_parameters python_parameters_launch.py 
[INFO] [launch]: All log files can be found below /home/bhbhchoi/.ros/log/2021-02-15-15-14-38-127277-bhbhchoi-900X3L-11707
[INFO] [launch]: Default logging verbosity is set to INFO
[INFO] [param_talker-1]: process started with pid [11720]
</code></pre></div></div>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ ros2 param get /custom_parameter_node my_parameter
String value is: earth
</code></pre></div></div>
<p>ì €ëŠ” ê²°ê³¼ê°€ ì˜ ë‚˜ì˜¤ëŠ”ì§€ í™•ì¸í•˜ê¸° ìœ„í•´ ì›ë˜ëŒ€ë¡œ ë˜ëŒë¦¬ëŠ” êµ¬ë¬¸ì€ ì£¼ì„ì²˜ë¦¬í•˜ê³  ë¹Œë“œ, ì†ŒìŠ¤ í•œ í›„ ì‹¤í–‰í–ˆìŠµë‹ˆë‹¤. ê³„ì†í•´ì„œ <code class="language-plaintext highlighter-rouge">earth</code>ë¡œ ì˜ ë‚˜ì˜¤ê³  ìˆìŒì„ ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>

<h1 id="ë§ˆë¬´ë¦¬">ë§ˆë¬´ë¦¬</h1>
<p>ROS2 ì²«ê±¸ìŒ ì •ë¦¬ ê²Œì‹œê¸€ì€ ì´ê²ƒìœ¼ë¡œ ë§ˆë¬´ë¦¬ í•˜ê² ìŠµë‹ˆë‹¤. ì•„ë˜ í˜ì´ì§€ë¥¼ ë²ˆì—­ë§Œ í•´ ë†“ì€ ê²ƒ ê°™ì€ ëŠë‚Œì´ ë“¤ì§€ë§Œ ROS2ë¥¼ ë§›ë³¼ ìˆ˜ ìˆì—ˆë˜ ì¢‹ì€ ê¸°íšŒê°€ ë˜ì—ˆìŠµë‹ˆë‹¤.</p>

<h1 id="ì°¸ê³ -ì‚¬ì´íŠ¸">ì°¸ê³  ì‚¬ì´íŠ¸</h1>
<p><a href="https://index.ros.org/doc/ros2/Tutorials/Using-Parameters-In-A-Class-Python/">ROS Index-ROS2 íŠœí† ë¦¬ì–¼ íŒŒë¼ë¯¸í„° ì‚¬ìš©(Python)</a></p>

:ET