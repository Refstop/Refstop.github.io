---
layout: post
read_time: true
show_date: true
title: "Bayesian Filter (1) Bayes 정리"
date: 2020-12-22 10:07:23 +/-TTTT
tags: [Probabilistic Robotics, SLAM, Bayesian Filter]
mathjax: yes
---
# Bayes 정리란?
<center> $\large{
P(H|E)=\frac{P(E|H)P(H)}{P(E)}
}$ </center>
$P(H): $사전확률 (가설, Hypothesis)  
$P(E|H): $ 가설 $H$를 만족할 때 $E$가 발생할 확률  
$P(E): $ 사건 E가 발생할 확률  
$P(H|E): $사후확률 (증거, Evidence)  

베이즈 정리란 쉽게 말해 확률을 어떻게 갱신할 수 있을지를 사전확률(Prior Probability)과 사후확률(Posterior Probability)의 관계로 나타낸 것입니다.
사전확률은 말 그대로 **사건이 발생하기 전의 사건이 발생할 확률**을 의미합니다. 사후확률 역시 별반 다르지 않습니다. 물론 **사건이 발생한 후의 사건이 발생할 확률**입니다.  

# 그녀가 나를 좋아할 확률
베이즈 확률을 이해하기 위해 재미있는 예시를 들고 왔습니다. 한 수학자가 여사친에게 발렌타인데이에 초콜릿을 받았습니다. 그런데 이 수학자는 완전한 이과뇌라서 친구가 자신을 좋아할 확률을 수학적으로 구하기로 했습니다. 여기서 그가 생각해낸 방법은 **베이즈 정리**입니다.  
수학자는 우선 그녀가 자신을 좋아할 확률을 좋아할 확률 50%, 좋아하지 않을 확률 50%로 잡았습니다. 아무런 근거가 없을 때 각각의 확률을 동일 비율로 잡는 것을 **이유 불충분의 원리**라고 합니다. 여기서 수학자가 잡은 이미 지금 상태에서 자신을 좋아할 확률이 바로 **사전확률**입니다. 위의 베이즈 정리에서 가설 $H$와 증거 $E$는 다음과 같습니다.
<center> $\large{
가설 \; H = ``그녀가\;날\;좋아함"이라는\;사건
}$ </center>
<center> $\large{
증거 \; E = "초콜릿을\;받았다"라는\;사건
}$ </center>
하지만 초콜릿을 받았다는 사실과 반반의 확률만으로는 사후확률을 구할 근거가 부족했습니다.  
그래서 수학자는 설문조사를 통해 일반적인 확률을 구해냈습니다. 수학자가 실시한 설문조사의 내용은 "좋아하는 사람에게 초콜릿을 줄 확률은?", 그리고 "호감이 없지만 초콜릿을 줄 확률" 이었습니다. 두 설문조사의 결과는 각각 40%, 30%가 나왔습니다. 알기 쉽게 그림으로 설명해 봅시다. 가로 10명, 세로 10명으로 총 100명의 사람이 있다고 합시다. 가로축을 좋아할 확률로 치면, 그림은 다음과 같습니다.  
![좋아할 확률만](/assets/img/particle filter/좋아할 확률만.png){: width="70%" height="70%"}  
이제 설문조사 결과에 따라 좋아하는 사람에게 초콜릿을 받았을 40%, 호감이 없지만 초콜릿은 받았을 30%를 표시해 봅시다.  
![초콜릿까지](/assets/img/particle filter/초콜릿까지.png){: width="70%" height="70%"}  
그림에 따르면 좋아하는 사람 중 20명이, 호감이 없는 사람 중 15명이 초콜릿을 받았습니다. 그렇다면 이제 초콜릿을 받은 상황만을 생각해 봅시다. 초콜릿을 받은 사람은 100명 중 35명, 즉 발렌타인데이에 이유 없이 초콜릿을 받을 확률은 35%입니다.이 말대로면 3년에 한번은 받는다는 말인데 저는 왜 못 받았을까요? 음.. 아무튼 초콜릿을 받을 확률을 0.35라고 해 봅시다. 그 중에서 좋아하는 사람에게 초콜릿을 받았을 사람은 100명 중 20명, 즉 확률로 따지면 0.2입니다. 이러한 확률은 사각형 방법을 쓰면 구하기 쉽습니다. 사각형의 가로축을 그녀가 날 좋아할 확률, 세로축을 초콜릿을 받을 확률로 설정합니다. 그러면 다음과 같은 사각형의 형태가 됩니다.  
![총확률](/assets/img/particle filter/총확률.png){: width="70%" height="70%"}  
사각형의 넓이는 세로축 좋아하는 사람에게 초콜릿을 줄 확률 $P(초콜릿|좋아함)$, 가로축 좋아할 확률 $P(좋아함)$을 곱한 0.2가 됩니다. 이 확률은 베이즈 정리에서 분자가 됩니다. 따라서 수학자가 계산한 초콜릿을 준 친구가 자신을 좋아할 확률은 $\frac{0.2}{0.35}=0.57$이 됩니다. 이를 수식으로 정리하면 다음과 같습니다.  
<center> $\large{
P(좋아함|초콜릿)=\frac{P(초콜릿|좋아함)P(좋아함)}{P(초콜릿)}
}$ </center>
하지만 여기에는 조금 오류가 있는데, 처음 그녀가 나를 좋아할/좋아하지 않을 확률이 0.5라는 것입니다. 사전확률이 옳다는 전제가 있어야 베이즈 정리가 빛을 볼 수 있습니다. 초콜릿을 받은 사건 말고도 같이 식사를 했다던가, 영화를 봤다던가 하는 사건들이 있으면, 사전확률이 점점 수정될 것입니다. 이런 원리를 이용하여 베이즈 정리는 인공지능 학습에 사용되기도 합니다. 참고로 제가 못받은 이유는 사전확률이 0퍼센트이기 때문입니다. 이것이 사전확률이 옳다는 전제의 중요성입니다.......  
슬프네요

# 다음 내용은?
Probabilistic Robotics에서 공부한 내용을 정리해서 올릴 예정입니다. 신뢰도 $bel(x_t)$를 이용한 필터 모델입니다. 아직 완전히 이해하지는 못했지만 조만간 올릴 수 있으면 좋겠네요.


# 참고 자료
<center> <iframe width="560" height="400" src="https://www.youtube.com/embed/Y4ecU7NkiEI" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe> </center>
베이즈 정리를 쉽고 재미있게 풀어낸 영상입니다. 이 게시글의 예시는 모두 이 영상을 정리한 것입니다.
